<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Property Deal - Card Game</title>
  <link rel="stylesheet" href="css/styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Home Screen -->
  <div id="home-screen" class="screen active">
    <div class="home-container">
      <div class="logo-section">
        <div class="logo">
          <div class="logo-cards">
            <div class="logo-card red"></div>
            <div class="logo-card blue"></div>
            <div class="logo-card yellow"></div>
            <div class="logo-card green"></div>
          </div>
          <h1>Property Deal</h1>
        </div>
        <p class="tagline">The Ultimate Property Trading Card Game</p>
      </div>

      <div class="home-actions">
        <button id="play-btn" class="btn btn-primary btn-large">
          <span class="btn-icon">&#9654;</span>
          Play with Friends
        </button>

        <div class="secondary-actions">
          <button id="join-btn" class="btn btn-secondary">
            <span class="btn-icon">&#128279;</span>
            Join Game
          </button>
          <button id="how-to-play-btn" class="btn btn-secondary">
            <span class="btn-icon">&#63;</span>
            How to Play
          </button>
        </div>
      </div>

      <div class="home-footer">
        <p>2-5 Players | ~15 min</p>
      </div>
    </div>
  </div>

  <!-- Name Entry Modal -->
  <div id="name-modal" class="modal">
    <div class="modal-content">
      <h2 id="modal-title">Enter Your Name</h2>
      <input type="text" id="player-name" placeholder="Your nickname" maxlength="15" autocomplete="off">
      <div id="game-code-input" class="hidden">
        <input type="text" id="join-code" placeholder="Game Code" maxlength="6" autocomplete="off">
      </div>
      <div class="modal-actions">
        <button id="modal-cancel" class="btn btn-secondary">Cancel</button>
        <button id="modal-confirm" class="btn btn-primary">Continue</button>
      </div>
    </div>
  </div>

  <!-- How to Play Modal -->
  <div id="rules-modal" class="modal">
    <div class="modal-content modal-large">
      <h2>How to Play</h2>
      <div class="rules-content">
        <section>
          <h3>Objective</h3>
          <p>Be the first player to collect <strong>3 complete property sets</strong> of different colors!</p>
        </section>

        <section>
          <h3>Your Turn</h3>
          <ol>
            <li><strong>Draw 2 cards</strong> from the deck</li>
            <li><strong>Play up to 3 cards</strong> from your hand:
              <ul>
                <li>Add money to your bank</li>
                <li>Place properties on the table</li>
                <li>Play action cards against opponents</li>
                <li>Charge rent on your properties</li>
              </ul>
            </li>
            <li><strong>End your turn</strong> (discard down to 7 cards if needed)</li>
          </ol>
        </section>

        <section>
          <h3>Card Types</h3>
          <div class="card-types">
            <div class="card-type">
              <div class="mini-card money">$</div>
              <span>Money - Add to bank for paying rent</span>
            </div>
            <div class="card-type">
              <div class="mini-card property"></div>
              <span>Property - Collect sets to win</span>
            </div>
            <div class="card-type">
              <div class="mini-card action">!</div>
              <span>Action - Special abilities</span>
            </div>
            <div class="card-type">
              <div class="mini-card rent">R</div>
              <span>Rent - Charge other players</span>
            </div>
          </div>
        </section>

        <section>
          <h3>Key Actions</h3>
          <ul>
            <li><strong>Rent:</strong> Charge players who must pay from bank/properties</li>
            <li><strong>Sly Deal:</strong> Steal a property (not from complete sets)</li>
            <li><strong>Forced Deal:</strong> Swap one of your properties for an opponent's (not from complete sets)</li>
            <li><strong>Deal Breaker:</strong> Steal a complete property set!</li>
            <li><strong>Just Say No:</strong> Block any action against you</li>
          </ul>
        </section>
      </div>
      <button id="close-rules" class="btn btn-primary">Got It!</button>
    </div>
  </div>

  <!-- Lobby Screen -->
  <div id="lobby-screen" class="screen">
    <div class="lobby-container">
      <div class="lobby-header">
        <button id="leave-lobby" class="btn btn-icon-only">&#8592;</button>
        <h2>Game Lobby</h2>
      </div>

      <div class="game-code-section">
        <p>Share this code with friends:</p>
        <div class="code-display">
          <span id="lobby-code">------</span>
          <button id="copy-code" class="btn btn-small">Copy</button>
        </div>
        <p class="code-hint">or share the link</p>
      </div>

      <div class="players-section">
        <h3>Players <span id="player-count">(0/5)</span></h3>
        <div id="player-list" class="player-list">
          <!-- Players will be added here -->
        </div>
      </div>

      <div class="lobby-actions">
        <button id="start-game" class="btn btn-primary btn-large" disabled>
          Waiting for players...
        </button>
      </div>
    </div>
  </div>

  <!-- Game Screen -->
  <div id="game-screen" class="screen">
    <div class="game-container">
      <!-- Top info bar -->
      <div class="game-header">
        <div class="turn-indicator">
          <span id="current-turn">Your Turn</span>
          <span id="actions-left">3 actions left</span>
        </div>
        <div class="deck-info">
          <div class="deck-stack">
            <span id="deck-count">106</span>
          </div>
        </div>
      </div>

      <!-- Game table -->
      <div class="game-table">
        <!-- Opponents area -->
        <div id="opponents-area" class="opponents-area">
          <!-- Opponent cards will be rendered here -->
        </div>

        <!-- Center area with action buttons -->
        <div class="center-area">
          <div id="action-prompt" class="action-prompt hidden">
            <!-- Action prompts appear here -->
          </div>
        </div>

        <!-- Player's area -->
        <div class="player-area">
          <div class="player-board">
            <div class="player-properties">
              <h4>Your Properties</h4>
              <div id="my-properties" class="property-sets">
                <!-- Property sets will be rendered here -->
              </div>
            </div>
            <div class="player-bank">
              <h4>Bank: $<span id="my-bank-total">0</span>M</h4>
              <div id="my-bank" class="bank-cards">
                <!-- Bank cards will be rendered here -->
              </div>
            </div>
          </div>

          <!-- Player's hand -->
          <div class="hand-section">
            <div id="my-hand" class="player-hand">
              <!-- Hand cards will be rendered here -->
            </div>
          </div>
        </div>
      </div>

      <!-- Action buttons -->
      <div class="game-actions">
        <button id="draw-btn" class="btn btn-action">Draw Cards</button>
        <button id="end-turn-btn" class="btn btn-action" disabled>End Turn</button>
      </div>

      <!-- Chat Panel -->
      <div id="chat-panel" class="chat-panel collapsed">
        <button id="chat-toggle" class="chat-toggle">
          <span class="chat-icon">&#128172;</span>
          <span id="chat-badge" class="chat-badge hidden">0</span>
        </button>
        <div class="chat-content">
          <div class="chat-header">
            <h4>Game Chat</h4>
            <button id="chat-close" class="chat-close">&times;</button>
          </div>
          <div id="chat-messages" class="chat-messages">
            <!-- Chat messages will appear here -->
          </div>
          <div class="chat-input-area">
            <input type="text" id="chat-input" placeholder="Type a message..." maxlength="200" autocomplete="off">
            <button id="chat-send" class="btn btn-primary btn-small">Send</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Target Selection Modal -->
  <div id="target-modal" class="modal">
    <div class="modal-content">
      <button class="modal-close-btn" data-modal="target">&times;</button>
      <h2 id="target-title">Select Target</h2>
      <div id="target-options" class="target-options">
        <!-- Target options will be rendered here -->
      </div>
      <div class="modal-actions">
        <button id="target-cancel" class="btn btn-secondary">Cancel</button>
        <button id="target-confirm" class="btn btn-primary" disabled>Confirm</button>
      </div>
    </div>
  </div>

  <!-- Payment Modal -->
  <div id="payment-modal" class="modal">
    <div class="modal-content modal-large">
      <h2>Pay <span id="payment-amount">$0</span>M</h2>
      <p id="payment-info">Select cards to pay with</p>
      <p id="payment-warning" class="hidden" style="text-align: center; color: #e74c3c; font-size: 14px; margin-bottom: 10px;"></p>
      <div class="payment-sections">
        <div class="payment-bank">
          <h4>Your Bank <button id="select-all-bank" class="btn btn-small" style="float: right; padding: 4px 10px; font-size: 11px;">Select All</button></h4>
          <div id="payment-bank-cards" class="payment-cards">
            <!-- Bank cards for payment -->
          </div>
        </div>
        <div class="payment-properties">
          <h4>Your Properties <button id="select-all-props" class="btn btn-small" style="float: right; padding: 4px 10px; font-size: 11px;">Select All</button></h4>
          <div id="payment-property-cards" class="payment-cards">
            <!-- Property cards for payment -->
          </div>
        </div>
      </div>
      <div class="payment-total">
        Selected: $<span id="payment-selected">0</span>M
      </div>
      <div class="modal-actions">
        <button id="say-no-btn" class="btn btn-danger hidden">Just Say No!</button>
        <button id="pay-btn" class="btn btn-primary">Pay</button>
      </div>
    </div>
  </div>

  <!-- Color Selection Modal -->
  <div id="color-modal" class="modal">
    <div class="modal-content">
      <button class="modal-close-btn" data-modal="color">&times;</button>
      <h2>Select Color</h2>
      <div id="color-options" class="color-options">
        <!-- Color options will be rendered here -->
      </div>
      <div class="modal-actions">
        <button id="color-cancel" class="btn btn-secondary">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Action Card Choice Modal -->
  <div id="action-choice-modal" class="modal">
    <div class="modal-content">
      <button class="modal-close-btn" data-modal="actionChoice">&times;</button>
      <h2 id="action-choice-title">Play Action Card</h2>
      <p id="action-choice-desc" style="text-align: center; color: #a0a0b0; margin-bottom: 20px;">What would you like to do with this card?</p>
      <div class="modal-actions" style="flex-direction: column; gap: 12px;">
        <button id="action-use-btn" class="btn btn-primary">Use Action</button>
        <button id="action-bank-btn" class="btn btn-secondary">Add to Bank ($<span id="action-bank-value">0</span>M)</button>
        <button id="action-cancel-btn" class="btn btn-secondary">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Rent Chart Modal -->
  <div id="rent-modal" class="modal">
    <div class="modal-content">
      <button class="modal-close-btn" data-modal="rent">&times;</button>
      <h2 id="rent-title">Rent Chart</h2>
      <div id="rent-chart" class="rent-chart">
        <!-- Rent chart will be rendered here -->
      </div>
      <div id="rent-current-info" class="rent-current-info"></div>
      <button id="close-rent" class="btn btn-primary">Close</button>
    </div>
  </div>

  <!-- Game Over Modal -->
  <div id="gameover-modal" class="modal">
    <div class="modal-content">
      <div class="winner-display">
        <div class="winner-crown">&#128081;</div>
        <h2 id="winner-name">Player Wins!</h2>
        <p>Collected 3 complete property sets!</p>
      </div>
      <div class="gameover-actions">
        <button id="play-again-btn" class="btn btn-primary btn-large">Play Again</button>
        <button id="back-home" class="btn btn-secondary">Back to Home</button>
      </div>
      <div id="play-again-status" class="play-again-status hidden"></div>
    </div>
  </div>

  <!-- Toast notifications -->
  <div id="toast-container"></div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="js/game.js"></script>
</body>
</html>
